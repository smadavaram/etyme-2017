%body
  %article.col-sm-12.col-md-12.col-lg-12
    / Widget ID (each widget will need unique ID)
    #wid-id-0.jarviswidget.jarviswidget-color-darken{"data-widget-deletebutton" => "false", "data-widget-editbutton" => "false"}
      %header
        %span.widget-icon
          %i.fa.fa-check
        %h2 On Boarding Profile Set Up
      / widget div
      %div
        / widget edit box
        .jarviswidget-editbox
          / This area used as dropdown edit box
        / end widget edit box
        / widget content
        .widget-body
          .row
            %form#wizard-1{:novalidate => "novalidate"}
              #bootstrap-wizard-1.col-sm-12
                .form-bootstrapWizard
                  %ul.bootstrapWizard.form-wizard
                    %li.active{"data-target" => "#step1"}
                      %a{"data-toggle" => "tab", :href => "#tab1"}
                        %span.step 1
                        %span.title Veryfy Number
                    %li{"data-target" => "#step2"}
                      %a{"data-toggle" => "tab", :href => "#tab2"}
                        %span.step 2
                        %span.title Personal information
                    %li{"data-target" => "#step3"}
                      %a{"data-toggle" => "tab", :href => "#tab3"}
                        %span.step 3
                        %span.title Social Media     
                    %li{"data-target" => "#step4"}
                      %a{"data-toggle" => "tab", :href => "#tab4"}
                        %span.step 4
                        %span.title Update Education
                    %li{"data-target" => "#step5"}
                      %a{"data-toggle" => "tab", :href => "#tab5"}
                        %span.step 5
                        %span.title Update Skills
                    %li{"data-target" => "#step6"}
                      %a{"data-toggle" => "tab", :href => "#tab6"}
                        %span.step 6
                        %span.title Client Information
                    %li{"data-target" => "#step7"}
                      %a{"data-toggle" => "tab", :href => "#tab7"}
                        %span.step 7
                        %span.title Designate
                    %li{"data-target" => "#step8"}
                      %a{"data-toggle" => "tab", :href => "#tab8"}
                        %span.step 8
                        %span.title Submit Doc
                    %li{"data-target" => "#step9"}
                      %a{"data-toggle" => "tab", :href => "#tab9"}
                        %span.step 9
                        %span.title Save Form
                  .clearfix
                .tab-content
                  #tab1.tab-pane.active
                    %br/
                    %h3
                      %strong Step 1
                      \- Veryfy Phone Number
                    .row
                      .col-sm-6
                        .form-group
                          .input-group
                            %span.input-group-addon
                              %i.fa.fa-mobile-phone.fa-lg.fa-fw
                            %input#phone_no.form-control.input-lg{:name => "phone_no", :placeholder => "Enter Phone number", :type => "text"}/
                      .col-sm-6
                        .form-group
                          .input-group
                            %a.btn.btn-primary.btn-lg{:href => "javascript:void(0);"} Veryfy
      
                    .row
                      .col-sm-6
                        .form-group
                          .input-group
                            %span.input-group-addon
                              %i.fa.fa-key.fa-lg.fa-fw
                            %input#otp.form-control.input-lg{:name => "otp", :placeholder => "Enter 6 Digit verification Code sent by SMS", :type => "text"}/
                      
                  #tab2.tab-pane
                    %br/
                    %h3
                      %strong Step 2
                      \- Personal Information
                    .row
                      #content.candidate-profile
                        .col-sm-12.col-md-12.col-lg-12
                          #wid-id-7.jarviswidget.jarviswidget-color-teal{"data-widget-attstyle" => "jarviswidget-color-teal", "data-widget-custombutton" => "false", "data-widget-editbutton" => "false", "data-widget-fullscreenbutton" => "false", "data-widget-sortable" => "false", :role => "widget", :style => ""}
                            %header{:role => "heading"}
                              %ul.nav.nav-tabs.pull-left.in#myTab
                                %li{class: ("active" if params[:tab] == 'basic_info' || params[:tab].nil?)}
                                  %a{"aria-expanded" => "true", "data-toggle" => "tab", :href => "#hr1"}
                                    %span.hidden-mobile.hidden-tablet Personal Information
                              %span.jarviswidget-loader
                                %i.fa.fa-refresh.fa-spin
                            / widget div
                            %div{:role => "content"}
                              .jarviswidget-editbox

                              .widget-body
                                .tab-content
                                  #hr1.tab-pane{class: ("active" if params[:tab] == 'basic_info' || !params[:tab].present?)}
                                    .tabbable.tabs-below
                                      .row
                                        .col-sm-12.col-md-12.col-lg-2
                                          .panel-body.status.profile-margin
                                            .text
                                              %div.profile-hover
                                                %div.pictureContainer
                                                  = filepicker_field_tag "" ,class: "hidden candi-logo", onchange:"candidateLogoUpload(event)","data-fp-crop-ratio" => "2/2",mimetypes: "image/*"
                                                  -if(current_candidate.photo.present?)
                                                    = image_tag current_candidate.photo,  style:"width:100px;height:100px", fit: 'clip',:class =>"candi-profile-pic img_pic"

                                                  -else
                                                    = image_tag image_path('avatars/m_sunny_big.png'),  style: "width:100px;height:100px", fit: 'clip', class: "img_pic"
                                            %p.text-center
                                              %i.fa.fa-camera
                                              %i.fa.fa-upload
                                        .col-sm-12.col-md-12.col-lg-10
                                          .panel-body.status.profile-margin
                                            .text
                                              %div.profile-hover
                                                %div.pictureContainer.col-md-offset-2
                                                  = filepicker_field_tag "" ,class: "hidden file", onchange:"employeevideoUpload(event)","data-fp-crop-ratio" => "2/2",mimetypes: "video/*"
                                                  -if(current_candidate.video.present?)
                                                    %video{:controls => "", :width => "100", :height=> "100"}
                                                      %source{:src => current_candidate.video, :type => "#{current_candidate.video_type}"}
                                                  -else
                                                    = image_tag image_path('avatars/m_sunny_big.png'),  style: "width:100px;height:100px", fit: 'clip',:class =>"video-pic"
                                            -#= button_tag "Upload Video", fit: 'clip',:class =>"video-pic img1"
                                            %p.text-center
                                              %i.glyphicon.glyphicon-chevron-left
                                              %i.fa.fa-video-camera
                                              %i.fa.fa-file-pdf-o
                                              %i.fa.fa-file-powerpoint-o
                                              %i.fa.fa-file-image-o
                                              %i.fa.fa-upload
                                              %i.glyphicon.glyphicon-fullscreen
                                              %i.glyphicon.glyphicon-chevron-right
                                      .row{style: "padding: 15px;"}
                
                                      =render partial: 'candidate/candidates/partials/basic_info_form',locals: {candidate: current_candidate}
                                      / =render partial: 'candidate/candidates/partials/basic_info_form',locals: {candidate: current_candidate}
                                      


                  #tab3.tab-pane
                    %br/
                    %h3
                      %strong Step 3
                      \- Social Media
                  #tab4.tab-pane
                    %br/
                    %h3
                      %strong Step 4
                      \- Update Education
                    .row
                      .col-sm-12.col-md-12.col-lg-12
                        =render partial: 'candidate/candidates/partials/education_form',locals:{education: current_candidate.educations}  
                      
                  #tab5.tab-pane
                    %br/
                    %h3
                      %strong Step 5
                      \- Update Skills
                    .row
                      .col-sm-12.col-md-12.col-lg-12
                        = render partial: 'candidate/candidates/partials/skill_form',locals: {user: current_candidate}  
                        
                  #tab6.tab-pane
                    %br/
                    %h3
                      %strong Step 6
                      \- Client Information
                    .row
                      .col-sm-12.col-md-12.col-lg-12
                          
                  #tab7.tab-pane
                    %br/
                    %h3
                      %strong Step 7
                      \- Designet
                  #tab8.tab-pane
                    %br/
                    %h3
                      %strong Step 8
                      \- Submit Doc                    
                    
                  #tab9.tab-pane
                    %br/
                    %h3
                      %strong Step 9
                      \- Save Form
                    %br/
                    %h1.text-center.text-success
                      %strong
                        %i.fa.fa-check.fa-lg
                        Complete
                    %h4.text-center Click next to finish
                    %br/
                    %br/
                  .form-actions
                    .row
                      .col-sm-12
                        %ul.pager.wizard.no-margin
                          /
                            <li class="previous first disabled">
                            <a href="javascript:void(0);" class="btn btn-lg btn-default"> First </a>
                            </li>
                          %li.previous.disabled
                            %a.btn.btn-lg.btn-default{:href => "javascript:void(0);"} Previous
                          /
                            <li class="next last">
                            <a href="javascript:void(0);" class="btn btn-lg btn-primary"> Last </a>
                            </li>
                          %li.next
                            %a.btn.btn-lg.txt-color-darken{:href => "javascript:void(0);"} Next
        / end widget content
      / end widget div
    / end widget
  / WIDGET END


- content_for :scripts do
  :javascript

    $(document).ready(function() {

      $('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
            // localStorage.setItem('activeTab', $(e.target).attr('href'));
            var id = $(e.target).attr("href").substr(1);
            window.location.hash = id;
          });
        var hash = window.location.hash;
        $('#myTab a[href="' + hash + '"]').tab('show');

      $( ".profile-pic" ).click(function()
      {
        $( ".file" ).trigger( "click" );
      });

      $('.resume').on("click",function(){

          $(".resume_file").trigger("click");

      });
      $( '.file-portfolio' ).on('click',function() {
        $('.fp__overlay').css({'z-index':'99999'});

     });


       $(".best_in_place").best_in_place();
       $(".best_in_place").on('change', function(event) {
          flash_success('Change Saved!');
      });
      $('#education_start_year').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#education_completion_year').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#experience_start_date').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#experience_end_date').datepicker({
        dateFormat : 'dd/mm/yy'
      });

    });
    function employeeLogoUpload(event){
      photo_url = event.fpfile.url
      $('.profile-pic').html('');
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{candidate_update_photo_path}",
       data: { photo: photo_url,authenticity_token: window._token },
       success: function (data) {
        $('.text img').attr("src",photo_url);
       }
     });
    }
    function uploadResume(event){
      resume_url = event.fpfile.url
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{upload_resume_candidates_path}",
       data: { resume: resume_url,authenticity_token: window._token },
       // success: function (data) {
       // }
     });
    }
    $.datepicker.setDefaults({
        changeYear: true,
        yearRange: "1900:2017",
        showMonthAfterYear: true,
        showButtonPanel: true,
        showAnim: "fold",
        selectOtherMonths: true,
        autoSize: true,
        dateFormat: "yy-mm-dd"

      });
    $(".edit_in_line").css("display","none");
    $('td').on('mouseover mouseout',function(){
    $(this).find('.editprofile-pic_in_line').toggle();

    });

    $(document).ready(function() {
  
      //Bootstrap Wizard Validations

        var $validator = $("#wizard-1").validate({
          
          rules: {
            phone_no: {
              required: true,
            },
            otp: {
              required: true,
            },
            email: {
              required: true,
              email: "Your email address must be in the format of name@domain.com"
            },
            fname: {
              required: true
            },
            lname: {
              required: true
            },
            country: {
              required: true
            },
            city: {
              required: true
            },
            postal: {
              required: true,
              minlength: 4
            },
            wphone: {
              required: true,
              minlength: 10
            },
            hphone: {
              required: true,
              minlength: 10
            }
          },
          
          messages: {
            fname: "Please specify your First name",
            lname: "Please specify your Last name",
            email: {
              required: "We need your email address to contact you",
              email: "Your email address must be in the format of name@domain.com"
            }
          },
          
          highlight: function (element) {
            $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
          },
          unhighlight: function (element) {
            $(element).closest('.form-group').removeClass('has-error').addClass('has-success');
          },
          errorElement: 'span',
          errorClass: 'help-block',
          errorPlacement: function (error, element) {
            if (element.parent('.input-group').length) {
              error.insertAfter(element.parent());
            } else {
              error.insertAfter(element);
            }
          }
        });
        
        $('#bootstrap-wizard-1').bootstrapWizard({
          'tabClass': 'form-wizard',
          'onNext': function (tab, navigation, index) {
            var $valid = $("#wizard-1").valid();
            if (!$valid) {
              $validator.focusInvalid();
              return false;
            } else {
              $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index - 1).addClass(
                'complete');
              $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index - 1).find('.step')
              .html('<i class="fa fa-check"></i>');
            }
          }
        });
        
    
      // fuelux wizard
        var wizard = $('.wizard').wizard();
        
        wizard.on('finished', function (e, data) {
          //$("#fuelux-wizard").submit();
          //console.log("submitted!");
          $.smallBox({
            title: "Congratulations! Your form was submitted",
            content: "<i class='fa fa-clock-o'></i> <i>1 seconds ago...</i>",
            color: "#5F895F",
            iconSmall: "fa fa-check bounce animated",
            timeout: 4000
          });
          
        });

    
    })


    $(document).ready(function() {
      $(".select2").select2({placeholder: "Select a User(s)"});
      $(".file_select").select2({placeholder: "Select Company Document"});
      $('.fileUpload').on("click",function(){
        $(".file").trigger("click");
        $('.fp__overlay').css({'z-index':'99999'});
      });
      var chatBody = $('#chat-body') ;
      chatBody.scrollTop(5000000000);
       $('.resume').on("click",function(){
          $(".resume_file").trigger("click");
      });
     $( ".video-pic" ).click(function() {
      $( ".file" ).trigger( "click" );
     });
      $( ".candi-profile-pic" ).click(function()
      {
        $( ".candi-logo" ).trigger( "click" );
      });
     $('.education_start_year, .education_completion_year, .start_date, .end_date').datepicker({
       autoclose: true,
       todayHighlight: true,
       format: "mm-dd-yy"
      });
      $('#myTab a').click(function(e) {
        e.preventDefault();
        $(this).tab('show');
      });
      $("ul.nav-tabs > li > a").on("shown.bs.tab", function(e) {
        var id = $(e.target).attr("href").substr(1);
        window.location.hash = id;
      });

      var hash = window.location.hash;
      $('#myTab a[href="' + hash + '"]').tab('show');

    });
    function uploadResume(event){
      resume_url = event.fpfile.url
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: " #{ upload_resume_candidates_path } ",
       data: { resume: resume_url,authenticity_token: window._token },
       success: function (data) {  }
     });
    }
    function candidateLogoUpload(event){
      photo_url = event.fpfile.url
      $('.profile-pic').html('');
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{ candidate_update_photo_path }",
       data: { photo: photo_url,authenticity_token: window._token },
       success: function (data) {
        $('.text.img_pic').attr("src",photo_url);
        location.reload();
       }
     });
    }
    function employeevideoUpload(event){
      video_url = event.fpfile.url
      video_type=event.fpfile.mimetype
      $('.video-pic').html('');
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{ update_video_candidates_path }",
       data: { video: video_url,authenticity_token: window._token, video_type: video_type },
       success: function (data) {
        $('.text img1').attr("src",video_url);
        location.reload();
       }
     });
    }
    

     $(document).ready(function () {
        addressLookup();
    });

    function addressLookup() {
      var address = document.getElementsByClassName('p-location');

      for(var i=0; i< address.length; i++){
        new google.maps.places.Autocomplete(address[i]);

        google.maps.event.addDomListener(address[i], 'keydown', function(event) {
          if (event.keyCode === 13) {
            event.preventDefault();
          }
        });
      }
    }
  

    $('.candidate-association').on('cocoon:after-insert', function(e, insertedItem) {
      addressLookup();

     $(".start_date, .end_date").datepicker({
        dateFormat : 'dd/mm/yy'
      });
    });

    
