- is_editable =  candidate == current_candidate
- unless own
  #navbar.text-right
    = yield :statuses
.content-i.my-profile
  .content-box
    .row.p-4
      .col-sm-4.col-md-5.col-lg-4.col-xl-4
        .user-profile.compact
          .up-head-w{:style => "background-image:url(#{candidate.photo.blank? ? asset_path('avatars/m_sunny_big.png') : candidate.photo})"}
            - if own
              = link_to '#', class: 'profile--link', onclick: "upload_file_ajax(candidateLogoUpload)" do
                .up-main-info
                  %h2.up-header
                    %i.icon-feather-camera
                  %h2.up-header
                    = candidate.full_name
                  %h6.up-sub-header
                    = candidate.associated_company&.name&.capitalize if candidate.associated_company.present?
            -else
              .up-main-info
                %h2.up-header
                  = candidate.full_name
                %h6.up-sub-header
                  = candidate.associated_company&.name&.capitalize if candidate.associated_company.present?
          .up-controls
            .row
              .col-sm-6{style: "display: flex;justify-content: space-evenly;"}
                - if current_user.present?
                  = contact_widget(candidate.email,candidate.phone,nil,color: '#3E4B5B; !important',chat_link: chat_link(candidate))
                - else
                  = contact_widget(candidate.email,candidate.phone,nil,color: '#3E4B5B; !important',chat_link: register_path,remote_false: true)
              .col-sm-6.text-right
                - if own
                  - if candidate.candidates_resumes&.last.present?
                    %a#resume-link.btn.btn-primary.btn-sm{:href => candidate.candidates_resumes&.last.resume, download: true, target: '_blank'}
                      %i.os-icon.os-icon-arrow-down6
                      %span Resume
                  - else
                    No Resume Available
                - else
                  / - if candidate.candidates_resumes.try(:primary_resume).try(:first).try(:resume).present?

                  /   -#%a.btn.btn-primary.btn-sm{:href => ""}
                  /   = link_to candidate.candidates_resumes.primary_resume.first.resume, class: "btn btn-primary btn-sm", target: "_blank" do
                  /     %i.os-icon.os-icon-arrow-down6
                  /     %span Resume
                  / - else
                  = link_to static_candidate_resume_path(candidate), class: "btn btn-primary btn-sm", target: "_blank" do
                    %i.os-icon.os-icon-arrow-up6
                    %span Resume

          .up-contents
            .m-b
              .row.m-b
                .col-sm-6.b-r.b-b
                  .el-tablo.centered.padded-v
                    = candidate.exp_words.html_safe
                .col-sm-6.b-b
                  .el-tablo.centered.padded-v
                    .value
                      = candidate.clients.count
                    .label
                      Clients
              .bar-label-left.font-weight-bold.element-wrapper
                %div.d-flex.justify-content-between.element-header.align-items-center
                  %h4.m-0
                    Contact Information
                  - if is_editable
                    %a.d-flex.justify-content-end{href: onboarding_profile_path}
                      %i.fi-pencil.pr-2
                      %span.bold
                        Edit Information
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Full Name
                    .bar-label-right
                      %span=do_ellipsis(candidate.full_name,15)
                      %span.text-success
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Phone number
                    .bar-label-right
                      %span=mask(candidate.phone, 3, "*")
                      %span.text-success
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Email
                    .bar-label-right
                      %span=mask(candidate&.email, 4, "*")
                      %span.text-success
                        = is_verify(!!candidate.confirmed_at)
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Age
                    .bar-label-right
                      %span= pluralize((Date.today.to_s(:number).to_i - candidate.dob.to_s(:number).to_i) / 10000,'year') rescue 'N/A'
                      %span.text-success
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Visa Status
                    .bar-label-right
                      %span=do_ellipsis(candidate.visas.last&.status,15)
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Current Location
                    .bar-label-right
                      %span=do_ellipsis(Candidate.last.criminal_check.last&.address&.split(",")&.drop(1)&.join(","), 16)
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span SSN(YES / NO)
                    .bar-label-right
                      %span= candidate.ssn.present? ? 'Yes' : 'No'
                .os-progress-bar.primary
                  .bar-labels
                    .bar-label-left.font-weight-bold
                      %span Relocation
                    .bar-label-right
                      %span= candidate.relocation ? 'Yes' : 'No'
                %h6.my-4 Linked Information
                %div.d-flex.justify-content-between.flex-wrap.w-100
                  - if candidate.skypeid.present?
                    .os-progress-bar.primary.w-50.justify-content-center
                      .bar-labels
                        .bar-label-left.font-weight-bold.d-flex.align-items-center
                          %i.fi-social-skype
                          %span.ml-2=do_ellipsis(candidate.skypeid, 15)

                  - if candidate.facebook_url.present?
                    .os-progress-bar.primary.w-50.justify-content-center
                      .bar-labels
                        %a{href: candidate.facebook_url, target: "_blank"}
                          .bar-label-left.font-weight-bold.d-flex.align-items-center
                            %i.fi-social-facebook
                            %span.ml-2 Facebook

                  - if candidate.gtalk_url.present?
                    .os-progress-bar.primary.w-50.justify-content-center
                      .bar-labels
                        %a{href: candidate.gtalk_url, target: "_blank"}
                          .bar-label-left.font-weight-bold.d-flex.align-items-center
                            %i.fi-social-google-plus
                            %span.ml-2 Google

                  - if candidate.twitter_url.present?
                    .os-progress-bar.primary.w-50.justify-content-center
                      .bar-labels
                        %a{href: candidate.twitter_url, target: "_blank"}
                          .bar-label-left.font-weight-bold.d-flex.align-items-center
                            %i.fi-social-twitter
                            %span.ml-2 Twitter

                  - if candidate.linkedin_url.present?
                    .os-progress-bar.primary.w-50.justify-content-center
                      .bar-labels
                        %a{href: candidate.linkedin_url, target: "_blank"}
                          .bar-label-left.font-weight-bold.d-flex.align-items-center
                            %i.fi-social-linkedin
                            %span.ml-2 Linkedin

        .element-wrapper
          .element-box.px-4.py-3
            %div.d-flex.justify-content-between.element-header.align-items-center
              %h4.m-0
                Education

              - if is_editable
                %a.d-flex.justify-content-end{href: onboarding_profile_path}
                  %i.fi-pencil.pr-2
                  %span.bold
                    Add new
            %div
              - if candidate.educations.count == 0
                .gray-600 Add your Education
              - else
                - candidate.educations.each do |edu|
                  .os-progress-bar.primary
                    .bar-labels
                      .bar-label-left
                        %div
                          %p.m-0="#{edu.degree_title&.capitalize} - #{edu.institute&.capitalize}"
                        %div
                          %p.m-0.text-muted=[edu.degree_level, edu.completion_year && ", Graduated #{edu.completion_year.year}"].join

        .element-wrapper
          .element-box.px-4.py-3
            %div.d-flex.justify-content-between.element-header.align-items-center
              %h4.m-0
                Certification

              - if is_editable
                %a.d-flex.justify-content-end{href: onboarding_profile_path}
                  %i.fi-pencil.pr-2
                  %span.bold
                    Add new
            %div

              - if candidate.certificates.count == 0
                .gray-600 Add your Certifications
              - else
                - candidate.certificates.each do |cert|
                  .os-progress-bar
                    .bar-labels
                      .bar-label-left
                        %div
                          %p.m-0="#{cert.title} - #{cert.institute&.capitalize}"
                        %div
                          %p.m-0.text-muted="#{cert.start_date&.year} - #{cert.end_date&.year}"
        .element-wrapper
          .element-box.px-4.py-3
            %div.d-flex.justify-content-between.element-header.align-items-center
              %h4.m-0
                Skills

              - if is_editable
                %a.d-flex.justify-content-end{href: onboarding_profile_path}
                  %i.fi-pencil.pr-2
                  %span.bold
                    Add new
            .element-info.border-0
              .element-info-text
                - candidate.skill_list.each do |sl|
                  .badge.badge-primary.p-2.mb-1
                    =sl
      .col-sm-8.col-xl-8
        .col-sm-12
          .element-wrapper
            .element-box
              %div.d-flex.justify-content-between.align-items-center.element-info
                .element-info-with-icon
                  .element-info-icon.m-0
                    %i.icon-notebook
                  .element-info-text.m-0
                    %h4.element-inner-header Portfolio

                - if is_editable
                  %a.d-flex.justify-content-end{href: onboarding_profile_path}
                    %i.fi-pencil.pr-2
                    %span.bold
                      Add new
              %div.d-flex.w-100.justify-content-center
                - if candidate.full_portfolios.present?
                  .portfolio-slick
                    - candidate.portfolios.each do |portfolio|
                      - if url_image?(portfolio.cover_photo)
                        %div.slide-container
                          %img{src: portfolio.cover_photo}
                      - if url_video?(portfolio.cover_photo)
                        %div.slide-container
                          %video{controls: true}
                            %source{src: portfolio.cover_photo}
                    - candidate.clients.each do |client|
                      - client.portfolios.each do |portfolio|
                        - if url_image?(portfolio.cover_photo)
                          %div.slide-container
                            %img{src: portfolio.cover_photo}
                        - if url_video?(portfolio.cover_photo)
                          %div.slide-container
                            %video{controls: true}
                              %source{src: portfolio.cover_photo}
                    - candidate.designations.with_no_client.each do |client|
                      - client.portfolios.each do |portfolio|
                        - if url_image?(portfolio.cover_photo)
                          %div.slide-container
                            %img{src: portfolio.cover_photo}
                        - if url_video?(portfolio.cover_photo)
                          %div.slide-container
                            %video{controls: true}
                              %source{src: portfolio.cover_photo}
                - else
                  %div.w-100.pv-4.d-flex.justify-content-center
                    %strong
                      No portfolios
            .element-box
              %div.d-flex.justify-content-between.align-items-center.element-info
                .element-info-with-icon.w-50
                  .element-info-icon
                    %i.icon-badge
                  .element-info-text
                    %h4.element-inner-header.m-0 Project History

                - if is_editable
                  %a.d-flex.justify-content-end{href: onboarding_profile_path}
                    %i.fi-pencil.pr-2
                    %span.bold
                      Add new
              - if candidate.designations.present? || (candidate.ever_worked_with_company && candidate.clients.present?)
                - candidate.designations.with_no_client.each do |c|
                  .element-info
                    .element-info-text
                      .mb-2
                        %div
                          %h5.mb-1.text-primary #{c.comp_name}
                          %span.mb-1.h6.d-block.text-secondary=  "As #{c.company_role}" if c.company_role.present?
                          %strong.font-weight-bold.font-sm.text-capitalize
                            ="#{c.start_date&.strftime('%B-%Y')} #{"-" if c.start_date.present? and c.end_date.present?}  #{c.end_date&.strftime('%B-%Y')}"
                          - if c.recruiter_name.present?
                            %div
                              %strong Recruiter
                              .element-inner-desc
                                %strong=c.recruiter_name

                - candidate.clients.each do |c|
                  .element-info
                    .element-info-text
                      .mb-2
                        %div
                          %h5.mb-1.text-primary #{c.name}
                          %span.mb-1.h6.d-block.text-secondary=  "At #{c.industry}" if c.industry.present?
                          %strong.font-weight-bold.font-sm.text-capitalize
                            = "#{c.start_date&.strftime('%B-%Y')} #{"-" if c.start_date.present? and c.end_date.present?} #{c.end_date&.strftime('%B-%Y')}"
                        .element-inner-desc
                          %P.m-0
                            %strong Industry
                            = c.industry
                        .element-inner-desc
                          %P.m-0
                            %strong Project Description
                            = c.project_description
                        .element-inner-desc
                          %P
                            %strong Role(s)
                            = c.role
                        %strong Reference
                        .element-inner-desc.pl-2
                          %p.m-0
                            %strong=c&.refrence_name&.capitalize
                        .element-inner-desc.pl-2
                          %p.m-0
                            %strong=c&.refrence_two_name&.capitalize
                        - if c.designation.present?
                          .element-inner-desc.pl-2
                            %p.m-0
                              %strong="Recruiter: #{c&.designation&.recruiter_name&.capitalize}"

                        -#%strong Reference
                        -#- if c.candidate == current_candidate and !c.refrence_two.present?
                        -#  = render 'candidate/candidates/partials/update_ref_two', client: c
                        -#- else
                        -#  .element-inner-desc.pl-2
                        -#    %p.m-0
                        -#      = "<strong>#{c.refrence_two_name.capitalize}</strong> endorse <strong>#{c.candidate.full_name}</strong> and their roles and responsibilities for the PROJECT".html_safe

              - else
                .element-info
                  .element-info-text
                    .mb-2
                      %div
                        %span.mb-1.h6.d-block.text-secondary There is no work Experience
                      .element-inner-desc
                        -if own
                          %P
                            = link_to "Add New One", '/onboarding_profile?tag=skill'

%script{:src => "https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"}
%script{:src => "https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"}

- content_for :head do
  %link{:href => "https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.css", :rel => "stylesheet", :type => "text/css"}
  %link{:href => "https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.8/slick-theme.min.css", :rel => "stylesheet", :type => "text/css"}

:javascript
  $('.portfolio-slick').slick({
    infinite: true,
    slidesToShow: 1,
    dots:true,
    arrows: true,
    speed: 500,
    fade: true,
  });

  window.onscroll = function() {myFunction()};
  var navbar = document.getElementById("navbar");
  var sticky = navbar.offsetTop;

  function myFunction() {
    if (window.pageYOffset >= sticky) {
      navbar.classList.add("sticky")
    } else {
      navbar.classList.remove("sticky");
    }
  }

  function candidateLogoUpload(url,type){
    photo_url = url
    $('.profile-pic').html('');
    $.ajax({
     type: 'POST',
     dataType: 'json',
     url: "#{ candidate_update_photo_path }",
     data: { photo: photo_url,authenticity_token: window._token },
     success: function (data) {
      $('.img_pic').removeClass('hidden').attr("src",photo_url);
      $('.img_pic_r').remove();
      location.reload();
     }
   });
  }

