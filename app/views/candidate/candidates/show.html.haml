#content
  .row
    .col-sm-12.col-md-12.col-lg-3
      .panel-body.status.profile-margin
        .text
          %div.profile-hover
            %p.imgDescription.col-sm-offset-4 Change Image
            %div.pictureContainer.col-md-offset-2
              = filepicker_field_tag "" ,class: "hidden file", onchange:"employeeLogoUpload(event)","data-fp-crop-ratio" => "2/2",mimetypes: "image/*"
              -if(current_candidate.photo.present?)
                = image_tag current_candidate.photo,  style:"width:100px;height:100px", fit: 'clip',:class =>"profile-pic image-setting"

              -else
                = image_tag image_path('default_user.png'),  style: "width:100px;height:100px", fit: 'clip',:class =>"profile-pic image-setting"

        %ul.links
          %li
            = filepicker_field_tag "" ,class: "hidden resume_file", onchange:"uploadResume(event)"
            - if !current_candidate.resume.present?
              = link_to "Upload CV" ,"#",class: 'resume btn btn-md btn-primary'
            - else
              = link_to "Change CV","#",class: 'resume btn btn-md btn-primary'

          %li
            %a{:href => "javascript:void(0);"}

          %li
            %a{:href => "javascript:void(0);"}



    .col-sm-12.col-md-12.col-lg-9
      #wid-id-7.jarviswidget.jarviswidget-color-teal{"data-widget-attstyle" => "jarviswidget-color-teal", "data-widget-custombutton" => "false", "data-widget-editbutton" => "false", "data-widget-fullscreenbutton" => "false", "data-widget-sortable" => "false", :role => "widget", :style => ""}
        %header{:role => "heading"}
          %ul.nav.nav-tabs.pull-left.in#myTab
            %li.active
              %a{"aria-expanded" => "true", "data-toggle" => "tab", :href => "#hr1"}
                %i.fa.fa-lg.fa-info-circle
                %span.hidden-mobile.hidden-tablet Basic Info
            %li
              %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr2"}
                %i.fa.fa-lg.fa-location-arrow
                %span.hidden-mobile.hidden-tablet
                  Address
            %li
              %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr3"}
                %i.fa.fa-lg.fa-graduation-cap
                %span.hidden-mobile.hidden-tablet
                  Educations
            %li
              %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr4"}
                %i.fa.fa-black-tie.fa-lg
                %span.hidden-mobile.hidden-tablet
                  Experience
          %span.jarviswidget-loader
            %i.fa.fa-refresh.fa-spin
        / widget div
        %div{:role => "content"}
          .jarviswidget-editbox

          .widget-body
            .tab-content
              -## Basic Info form TAB
              #hr1.tab-pane.active
                = link_to 'Add Skills' ,"#",class:'btn btn-primary pull-right margin-bottom-5 margin-right-10',"data-target" => "#skills", "data-toggle" => "modal"
                .tabbable.tabs-below
                  =render partial: 'candidate/candidates/partials/basic_info',locals: {candidate: current_candidate}
                = render partial: 'candidate/candidates/partials/skills_modal'

              -# Locations form TAB
              #hr2.tab-pane
                -#%button.btn.btn-primary{"data-target" => "#myModal", "data-toggle" => "modal"}
                -#  Add Location
                .tabbable.tabs-below
                  =render partial: 'candidate/candidates/partials/location',locals:{address: current_candidate.address}
              #hr3.tab-pane
                %button.btn.btn-primary.pull-right.margin-bottom-5.margin-right-10{"data-target" => "#education", "data-toggle" => "modal"}
                  New
                .tabbable.tabs-below
                  = render partial: 'candidate/educations/partials/education_detail',locals: {user: current_candidate}
                = render partial: 'candidate/educations/partials/form' ,locals: {user: current_candidate}
              #hr4.tab-pane
                %button.btn.btn-primary.pull-right.margin-bottom-5.margin-right-10{"data-target" => "#experience", "data-toggle" => "modal"}
                  New
                .tabbable.tabs-below
                  = render partial: 'candidate/experiences/partials/experience_detail',locals: {user: current_candidate}
                = render partial: 'candidate/experiences/partials/form' ,locals: {user: current_candidate}



- content_for :scripts do
  :javascript

    $(document).ready(function() {

      $('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
            // localStorage.setItem('activeTab', $(e.target).attr('href'));
            var id = $(e.target).attr("href").substr(1);
            window.location.hash = id;
          });
        var hash = window.location.hash;
        $('#myTab a[href="' + hash + '"]').tab('show');

      $( ".profile-pic" ).click(function()
      {
        $( ".file" ).trigger( "click" );
      });

      $('.resume').on("click",function(){

          $(".resume_file").trigger("click");

      });


       $(".best_in_place").best_in_place();
       $(".best_in_place").on('change', function(event) {
          flash_success('Change Saved!');
      });
      $('#education_start_year').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#education_completion_year').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#experience_start_date').datepicker({
        dateFormat : 'dd/mm/yy'
      });
      $('#experience_end_date').datepicker({
        dateFormat : 'dd/mm/yy'
      });

    });
    function employeeLogoUpload(event){
      photo_url = event.fpfile.url
      $('.profile-pic').html('');
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{candidate_update_photo_path}",
       data: { photo: photo_url,authenticity_token: window._token },
       success: function (data) {
        $('.text img').attr("src",photo_url);
       }
     });
    }
    function uploadResume(event){
      resume_url = event.fpfile.url
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{upload_resume_candidates_path}",
       data: { resume: resume_url,authenticity_token: window._token },
       // success: function (data) {
       // }
     });
    }
    $.datepicker.setDefaults({
        changeYear: true,
        yearRange: "1900:2017",
        showMonthAfterYear: true,
        showButtonPanel: true,
        showAnim: "fold",
        selectOtherMonths: true,
        autoSize: true,
        dateFormat: "yy-mm-dd"

      });
    $(".edit_in_line").css("display","none");
    $('td').on('mouseover mouseout',function(){
    $(this).find('.editprofile-pic_in_line').toggle();

    });
