-if @post.present?
  $("#job-invitation-multiple-#{@job.id}").modal("toggle");
-else
  $('.remote_container').empty().html("#{ j render 'company/job_applications/partials/modal_create_multipile_for_candidate.html.haml' , job: @job, job_application: @job_application}");
  $('#job-invitation-multiple-#{@job.id} ').modal('toggle');
  set_candidates();
  set_client_partner_select('#select_client_partner', "Please Select Or Add new Client Partner");
  set_candidate_resumes('#select_candidate_resumes', "Please Select Or Add new Resume");

  :plain
    $('.resume_field').change(function () {
      var uploaded_link = $('.resume_field').val();
      urls = uploaded_link.split('/');
      var mySelect = $("#select_candidate_resumes").append(`<option value='${uploaded_link}' selected=true>${urls[urls.length-1]}</option>`);
      mySelect.trigger("change");
    });
  
    function set_hr(){
      $("#select_candidate_resumes").val(null).trigger('change');
      $.ajax({
        url: "/api/company/candidates/"+$("#temp_candidates").val(),
        cache: false,
        success: function(data){
          $(".hr_field").val(data.recruiter_name);
        }
      });
    }

    function set_candidates(){
      $('#temp_candidates').select2({
        placeholder: "Select a Candidate",
        ajax: {
            url: '/api/company/candidates/get_candidates', // Ensure this matches your Rails routes
            dataType: 'json',
            delay: 250,
            data: function (params) {
                return {
                    q: params.term, // This matches params[:q] in your Rails controller
                    page: params.page
                };
            },
            processResults: function (data, params) {
                params.page = params.page || 1;

                return {
                    results: data.results, // Changed from data.items to data.results
                    pagination: {
                        more: data.pagination.more // Use the 'more' flag from the response
                    }
                };
            },
            cache: true
        },
        minimumInputLength: 1,
      }).on('select2:select', function(e) {
        var selectedData = e.params.data;
        console.log('Selected item:', selectedData);
        set_hr();
      });
    }
