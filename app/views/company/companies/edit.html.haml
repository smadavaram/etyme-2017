#ribbon
  %ol.breadcrumb
    = render_breadcrumbs


.col-lg-3.col-md-3
  .panel-body.status.profile-margin
    .text
      %div
        //= f.label :filepicker_url, "Upload Your Avatar:"
        = filepicker_field_tag "" ,class: "hidden file", onchange:"employeeLogoUpload(event)"
        -if(current_user.photo.present?)
          = image_tag current_user.photo,  style:"width:100px;height:100px", fit: 'clip',:class =>"profile-pic image-setting"
        -else
          = image_tag image_path('default_user.png'),  style: "width:100px;height:100px", fit: 'clip',:class =>"profile-pic image-setting"
    %ul.links
      %li

      %li
        %a{:href => "javascript:void(0);"}

      %li
        %a{:href => "javascript:void(0);"}



.col-lg-9.col-md-9
  #wid-id-7#content.jarviswidget.jarviswidget-color-teal{"data-widget-attstyle" => "jarviswidget-color-teal", "data-widget-custombutton" => "false", "data-widget-editbutton" => "false", "data-widget-fullscreenbutton" => "false", "data-widget-sortable" => "false", :role => "widget", :style => ""}
    %header{:role => "heading"}
      %ul.nav.nav-tabs.pull-left.in
        %li.active
          %a{"aria-expanded" => "true", "data-toggle" => "tab", :href => "#hr1"}
            %i.fa.fa-lg.fa-arrow-circle-o-down
            %span.hidden-mobile.hidden-tablet Company Info
        %li
          %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr2"}
            %i.fa.fa-lg.fa-arrow-circle-o-up
            %span.hidden-mobile.hidden-tablet
              Locations
        %li
          %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr3"}
            %i.fa.fa-lg.fa-arrow-circle-o-up
            %span.hidden-mobile.hidden-tablet
              Owner
        %li
          %a{"aria-expanded" => "false", "data-toggle" => "tab", :href => "#hr4"}
            %i.fa.fa-lg.fa-arrow-circle-o-up
            %span.hidden-mobile.hidden-tablet
              Attachments
      %span.jarviswidget-loader
        %i.fa.fa-refresh.fa-spin
    / widget div
    %div{:role => "content"}
      .jarviswidget-editbox

      .widget-body
        .tab-content
          #hr1.tab-pane.active
            .tabbable.tabs-below
              .tab-content.padding-10
                %table.table.table-striped
                  %tbody
                    %tr
                      %th{style:'width:50%'}
                        Name
                      %td{style:'width:50%'}
                        = best_in_place current_company, :name, :as => :input
                    %tr
                      %th
                        Email
                      %td
                        = best_in_place current_company,:email, :as => :input

                    %tr
                      %th
                        Phone
                      %td
                        = best_in_place current_company,:phone, :as => :input
                    %tr
                      %th
                        Description
                      %td
                        = best_in_place current_company,:description, :as => :textarea
                    %tr
                      %th
                        Time Zone
                      %td
                        = best_in_place current_company,:time_zone, :as => :input
                    %tr
                      %th
                        Twitter URl
                      %td
                        = best_in_place current_company,:twitter_url, :as => :input
                    %tr
                      %th
                        LinkedIn URl
                      %td
                        = best_in_place current_company,:linkedin_url, :as => :input
                    %tr
                      %th
                        Google URl
                      %td
                        = best_in_place current_company,:google_url, :as => :input

          #hr2.tab-pane
            %button.btn.btn-primary{"data-target" => "#myModal", "data-toggle" => "modal"}
              Add Location
            .tabbable.tabs-below
              .tab-content.padding-10
                %table.table.table-striped
                  %thead
                    %tr
                      %th{style:'width:20%'}
                        Name
                      %th{style:'width:20%'}
                        Country
                      %th{style:'width:20%'}
                        City
                      %th{style:'width:20%'}
                        State
                      %th{style:'width:20%'}
                        Zipcode
                  - current_company.locations.each do |location|
                    - next if location.new_record?
                    %tbody
                      %tr
                        %td
                          = best_in_place location, :name, :as => :input
                        %td
                          = best_in_place location.address, :country, :as => :select, :collection => CS.countries.sort.map{|k,v|[k,v]}
                        %td
                          = best_in_place location.address,:city, :as => :input
                        %td
                          = best_in_place location.address,:state, :as => :input
                        %td
                          = best_in_place location.address,:zip_code, :as => :input
            =render 'company/locations/partials/location_form'

          #hr3.tab-pane
            .tabbable.tabs-below
              .tab-content.padding-10
                %table.table.table-striped
                  %tbody
                    %tr
                      %th
                        Name
                      %td
                        = current_company.owner.full_name
                    %tr
                      %th
                        Email
                      %td
                        = current_company.owner.email
                    %tr
                      %th
                        Phone
                      %td
                        = current_company.owner.phone

          #hr4.tab-pane
            %button.btn.btn-primary{"data-target" => "#attachmentModal", "data-toggle" => "modal"}
              Add Attachment
            .tabbable.tabs-below
              .tab-content.padding-10
                %table.table.table-striped
                  %thead
                    %tr
                      %th{style:'width:20%'}
                        Name
                      %th{style:'width:20%'}
                        Description
                  - current_company.company_docs.each do |document|
                    - next if document.new_record?
                    %tbody
                      %tr
                        %td
                          = best_in_place document, :name, :as => :input
                        %td
                          = best_in_place document, :description, :as => :input


            =render 'company/company_docs/partials/attachment_form'

- content_for :scripts do
  :javascript
    $(document).ready(function() {
      $( ".profile-pic" ).click(function()
      {
        $( ".file" ).trigger( "click" );
      });
      $(".best_in_place").best_in_place();
    });
    function employeeLogoUpload(event){
      photo_url = event.fpfile.url
      $('.profile-pic').html('');
      $.ajax({
       type: 'POST',
       dataType: 'json',
       url: "#{update_photo_path}",
       data: { photo: photo_url,authenticity_token: window._token },
       success: function (data) {
        $('.text img').attr("src",photo_url);
       }
     });
    }

    $(".edit_in_line").css("display","none");
    $('td').on('mouseover mouseout',function(){
    $(this).find('.editprofile-pic_in_line').toggle();
    });
