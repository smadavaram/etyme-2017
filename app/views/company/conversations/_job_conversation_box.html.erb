

<div class="row margin-top-10" style="height: 5vh" >
  <div class="col-6 branchout-back">

    <div class="row branch-out" style="margin-left: 20px;margin-top: -11px;margin-bottom: -2px;">
      <i class="fa fa-arrow-circle-left" style="margin-right: 10px;font-size: 30px;color: #047BF8;" onclick="myFunction1()"></i>
      <i class="fa fa-arrow-circle-right" style="margin-left: 10px;font-size: 30px;color: #047BF8;" onclick="myFunction()"></i>
<!--      <img src="/assets/collabs.png" style="margin-left: 45px; height: 24px; width: 27px;" onclick="myFunction()"></img>-->
<!--      <span>Collaborators</span>-->
    </div>
  </div>
  <div class="col-6 branchout-mobile" style="margin-left: 284px;">
    <div class="row branch-out dropdown" style="justify-content: flex-end">
      <button type="button" class="btn4-style dropbtn" onclick="btnClick()" id="btn1"><i class="fa fa-plus"></i> Branch Out</button>
      <div class="dropdown-content" style="margin-left: -70px;font-size: 12px;">
        <a href="#">Interview</a>
        <a href="#">Document Collection</a>
        <a href="#">Navigation</a>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-10 col-md-10 col-lg-10" >
    <div class="row branch-out-content" style="justify-content: flex-start">
      <div>
        <button type="button" class="btn1-style" >Main</button>
      </div>
      <div id="myDIV" style="display:none; ">
        <div style=" display: flex">
          <div>
            <button type="button" class="btn2-style" >Interview</button>
          </div>
          <div>
            <button type="button" class="btn3-style" >Document Collection</button>
          </div>
          <div>
            <button type="button" class="btn2-style" >Navigation</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-0 col-sm-2 col-md-2 col-lg-2 branchout-desktop">
    <div class="row branch-out" style="justify-content: flex-end">
      <button type="button" class="btn4-style" id="clickon1"><i class="fa fa-plus"></i> Branch Out</button>
    </div>
  </div>

</div>

<div class="row chat-box" style="background-color: white; height: 82vh">

  <div class="row chat-box-header" >
    <div class="col-sm-6 col-lg-6 col-md-6">
      <div class="div-chat-middle-etymeflow" ><span class=" row chat-middle-etymeflow" >Etyme Flow</span></div>
    </div>
    <% opt_obj = conversation.chatable_type == "Group" ? conversation.chatable : (conversation.senderable == current_user ? conversation.recipientable : conversation.senderable) if conversation.present? %>

    <div class="col-sm-6 col-lg-6 col-md-6">
      <div class="row vidoebutton-style-div" >
        <div class="row" id="videobutton" style="margin-right: 2px; display: none">
          <div class="chat-div-style" id="myDIV2"><i class="fa fa-calendar calender-style"></i></div>
          <div class="chat-div-style" id="myDIV3"><i class="fa icon-phone calender-style"></i></div>
          <div class="chat-div-style" id="myDIV4"><i class="fa fa-video-camera calender-style"></i></div>
        </div>
        <div class="chat-div-style" onclick="showDivClick()" id="showdiv"><i class="fa fa-ellipsis-v calender-style" style="margin-left: 40%;"></i></div>
      </div>
    </div>
  </div>

  <div style="width: 100%; height: 58vh;  border-bottom: 1px solid #F2F4F8;overflow: scroll; padding: 10px">

    <div class="chat-content" id="conversation_<%= conversation.id if conversation.present? %>">
      <div id="all-infinite-scrolling-msg" style="display:none"></div>
      <%= hidden_field_tag "prev_date", nil %>
    </div>

    <div id="videobutton1" class="mobile-insidechat-icons">
      <div class="row send-icons" style="justify-content: center">
        <i class="fa fa-text-height" style="margin-right: 12px;margin-top: 8px;"></i>
        <i class="fa fa-exclamation" style="margin-right: 12px;margin-top: 8px;"></i>
        <%= button_tag type: "button", class: "btn p-0", style: "background: transparent;box-shadow: none;", onclick: "$('##{"chat-templates-#{conversation.try(:id)}"}').modal('show')" do %>
          <i class="fa fa-paperclip" style="margin-right: 12px;margin-top: 8px;"></i>
        <% end %>
        <i class="fa fa-smile-o" style="margin-right: 12px;margin-top: 8px;" ></i>
        <img src="/assets/gif.png" style="margin-right: 12px;margin-top: 8px;"></img>
        <img src="/assets/sticker.png" style="margin-right: 12px;margin-top: 8px;"></img>
        <i class="fa fa-calendar" style="margin-right: 12px;margin-top: 8px;"></i>
        <img src="/assets/flow.png" style="margin-right: 12px;margin-top: 8px;"></img>
        <img src="/assets/bulb.png" style="margin-right: 12px;margin-top: 8px;"></img>
        <img src="/assets/checked.png" style="margin-right: 12px;margin-top: 8px;"></img>
        <i class="fa fa-ellipsis-h" style="margin-right: 12px;margin-top: 8px;"></i>
      </div>
    </div>

  </div>

  <div  class="row message-send-row-mobile" >

    <div class= "row" style="width: 100%;  height:50%;  margin-left: 17px" >
      <div><button id="showdiv1" onclick="btnClick()" class="buttonstyle2"><i class="fa fa-ellipsis-v option-mobile-style"></i></button></div>
      <% if @conversation.present? %>
        <%= form_for([conversation, ConversationMessage.new], :remote => true, :html => {:style => 'width:100%;',class: "chat_form",id: "conversation_form_#{conversation.try(:id)}"}) do |f| %>
          <%= f.text_field :body, class: 'form-control input-sm chat_input mobile-send-text-div-style', autocomplete: "off", placeholder: 'Type your message here...', required: true, "data-cid" => conversation.id, id: "con-text-#{conversation.id}-#{current_user.class}-#{current_user.id}" %>
        <% end %>
      <% end %>
      <%= button_tag( class: "btn p-0 button-style1 send-message_class", style: "background: transparent;box-shadow: none;",id:"send-message") do %>
        <img src="/assets/send.png"></img>
      <% end %>
    </div>


    <div class="row mobile-chat-send-icons" >
      <div class="col-sm-8 col-md-8 col-lg-8">
        <div class="row send-icons">
          <i class="fa fa-text-height" style="margin-right: 15px"></i>
          <i class="fa fa-exclamation" style="margin-right: 15px"></i>
          <%= button_tag type: "button", class: "btn p-0", style: "background: transparent;box-shadow: none;", onclick: "$('##{"chat-templates-#{conversation.try(:id)}"}').modal('show')" do %>
            <i class="fa fa-paperclip" style="margin-right: 15px"></i>
          <% end %>
          <i class="fa fa-smile-o" style="margin-right: 15px" ></i>
          <img src="/assets/gif.png" style="margin-right: 15px"></img>
          <img src="/assets/sticker.png" style="margin-right: 15px"></img>
          <i class="fa fa-calendar" style="margin-right: 15px"></i>
          <img src="/assets/flow.png" style="margin-right: 15px"></img>
          <img src="/assets/bulb.png" style="margin-right: 15px"></img>
          <img src="/assets/checked.png" style="margin-right: 15px"></img>
          <i class="fa fa-ellipsis-h" style="margin-right: 15px"></i>
        </div>
      </div>
      <div class="col-sm-4 col-md-4 col-lg-4">
        <div class="row send-line">
          <%= button_tag( class: "btn p-0 send-message_class", style: "background: transparent;box-shadow: none;",id:"send-message") do %>
            <img src="/assets/send.png"></img>
          <% end %>
        </div>
      </div>
    </div>

  </div>
</div>



<% content_for :modals do %>
  <%= render('shared/chat_document_templates', conversation: @conversation) if @conversation.present? %>
<% end %>

<% content_for :scripts do %>
  <script>
      function onCompanyFileUpload(event) {
          $('#file-name_uploaded').html("<span>" + event.fpfile.filename + "</span><hr/>");
      }
      function send_message(id){
          $.ajax({
              url: `/company/conversations?conversation=${id}`,
              type: "POST",
              dataType: "script",
              success: function (data) {
              }
          });
      }
      $(document).ready(function () {
          set_company_users_select('#select_sell_company_contacts', "Please Select Signers", "#sell_contract_company");
          <%# unless conversation&.job_application %>
          <% unless request.fullpath.include?("job_applications") %>
          $('.collapsible').css('padding', '6px 18px');
          $('#collapsible_job_application').removeClass('ml-2 mr-2')
          $('#collapsible_job_application').removeClass('mt-4')
          $('#collapsible_job_application').addClass('mt-2')
          <% end %>
          <%# end %>
          $.ajax({
              url: "<%= messages_conversation_conversation_messages_path(conversation||0) %>",
              type: "GET",
              dataType: "script",
              success: function (data) {
                  console.log(data);
                  $("#conversation_<%=conversation&.id||0 %>").parent().scrollTop($("#conversation_<%=conversation&.id||0 %>").parent()[0].scrollHeight);
              }
          });
      });

      // $("#btn1").on("click", function(){
      //     console.log('btn clciked')
      //     debugger
      //     $("#myDIV").toggle('show');
      // });
      $("#clickon1").on("click", function(){
          $("#myDIV").toggle('show');
      });
      // $("#showdiv").on("click", function(){
      //
      //     $("#videobutton").toggle('show');
      // });
      $("#showdiv1").on("click", function(){
          $("#videobutton1").toggle('show');
      });
      function btnClick(){
          $("#myDIV").toggle('show');
      }

      function showDivClick(){

          $("#videobutton").toggle('show');
      }
      $('.send-message_class').on('click', function(e){
          form_id = $(".chat_form").attr('id')
          $('#'+form_id).submit()
      });
  </script>
<% end %>
